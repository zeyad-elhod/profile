<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cars AI Project</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .table-wrap{overflow:auto; margin-top:12px}
    table{width:100%; border-collapse:collapse}
    th,td{padding:8px 10px; border:1px solid #e6eef6; text-align:left}
    th{background:#f1f6fb}
  </style>
</head>
<body>
  <main class="container">
    <header class="header">
      <h1 class="name">Cars AI Project</h1>
    </header>

    <section class="section">
      <p>Below are sample rows from the bundled `cars.db`:</p>
      <div id="status">Loadingâ€¦</div>
      <div class="table-wrap" id="table-wrap" style="display:none"></div>
    </section>
  </main>

  <script>
    async function loadCars(){
      const status = document.getElementById('status');
      const wrap = document.getElementById('table-wrap');
      try{
        const res = await fetch('/api/cars');
        // attempt to parse JSON body (may contain error message)
        let body;
        try{ body = await res.json(); }catch(e){ body = null }
        if(!res.ok){
          const msg = body && (body.message || body.error) ? (body.message || body.error) : `HTTP ${res.status}`;
          throw new Error(msg);
        }
        const rows = body || [];
        if(!Array.isArray(rows)) throw new Error('Invalid data');
        if(rows.length === 0){
          status.textContent = 'No rows returned.';
          return;
        }
        status.style.display = 'none';
        wrap.style.display = 'block';
        const table = document.createElement('table');
        const thead = document.createElement('thead');
        const headerRow = document.createElement('tr');
        // build headers from keys of first row
        Object.keys(rows[0]).forEach(k => {
          const th = document.createElement('th');
          th.textContent = k;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);
        table.appendChild(thead);
        const tbody = document.createElement('tbody');
        rows.forEach(r => {
          const tr = document.createElement('tr');
          Object.keys(r).forEach(k => {
            const td = document.createElement('td');
            td.textContent = r[k] === null ? '' : r[k];
            tr.appendChild(td);
          });
          tbody.appendChild(tr);
        });
        table.appendChild(tbody);
        wrap.appendChild(table);
      }catch(err){
        status.textContent = 'Failed to load data: ' + (err.message || err);
      }
    }
    loadCars();
  </script>
</body>
</html>
